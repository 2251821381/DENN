import os

import numpy as np
import torch
from torch.utils.data import TensorDataset
from transformers import BertTokenizerFast

aapd_topics = [
    'cs.IR', 'stat.ME', 'quant-ph', 'cs.IT', 'math.IT', 'stat.AP', 'cs.CV', 'cs.CL', 'cs.AI',
    'math.NA', 'cs.MS', 'cs.CR', 'cs.SE', 'cs.LG', 'cs.NI', 'cs.SY', 'cs.DS', 'cs.CC',
    'cs.FL', 'cs.RO', 'math.OC', 'cs.MA', 'cs.PF', 'cs.SI', 'physics.soc-ph', 'cs.DC', 'cs.DB',
    'math.CO', 'stat.ML', 'math.PR', 'cs.NE', 'cs.DM', 'cond-mat.stat-mech', 'cs.LO', 'cs.CY', 'cond-mat.dis-nn',
    'cs.NA', 'cs.CE', 'cs.SC', 'cs.GT', 'cs.HC', 'q-bio.QM', 'cs.DL', 'q-bio.NC', 'cs.CG',
    'cmp-lg', 'cs.PL', 'math.LO', 'math.NT', 'cs.MM', 'math.ST', 'stat.TH', 'nlin.AO', 'physics.data-an'
]

rcv1v2_topics = [
    'ecat', 'e21', 'e212', 'ccat', 'c18', 'c181', 'c17', 'c171', 'mcat', 'm12', 'm14', 'm141', 'gcat', 'gpol', 'e12',
    'g15', 'g154', 'c15', 'c151', 'c1511', 'c152', 'm11', 'gpro', 'gent', 'gfas', 'm13', 'm131', 'c24', 'c33', 'e13',
    'e131', 'e51', 'e512', 'e211', 'gvio', 'gdip', 'c14', 'm132', 'c21', 'gvote', 'gcrim', 'gdef', 'c13', 'gjob', 'e41',
    'c42', 'c31', 'c173', 'c174', 'm143', 'c11', 'c183', 'c16', 'genv', 'c41', 'c411', 'godd', 'e132', 'c34', 'c22',
    'c32', 'c12', 'g158', 'c312', 'm142', 'c172', 'gspo', 'ghea', 'c23', 'grel', 'g157', 'c182', 'e31', 'gdis', 'gwea',
    'e71', 'gwelf', 'c311', 'e11', 'e311', 'g153', 'g151', 'g152', 'c331', 'e121', 'g155', 'gsci', 'e14', 'e143', 'e511',
    'e513', 'c313', 'e141', 'e411', 'e61', 'gobit', 'g156', 'gtour', 'e142', 'g159', 'e313', 'e312', 'gmil'
]

SemEval_topics = [
    'anger', 'anticipation', 'disgust', 'fear', 'joy', 'love', 'optimism', 'pessimism', 'sadness', 'surprise', 'trust']


Amazon_topics = ['rattles', 'aquariums', 'crib_toys_attachments', 'bath', 'shampoo_conditioner_sets', 'jams_preserves_gifts', 'hair_perms_texturizers', 'game_accessories', 'feeding', 'vehicles_remote_control', 'gardening_tools', 'baby_toddler_toys', 'bags_cases', 'packaged_breads', 'marble_runs', 'medical_supplies_equipment', 'sausages', 'safety', 'small_animals', 'travel_systems', 'stacking_nesting_toys', 'tools_accessories', 'kickball_playground_balls', 'pork', 'educational_repellents', 'flash_cards', 'fruit', 'rails_rail_guards', 'breakfast_cereal_bars', 'allergy', 'air_fresheners', 'aprons_smocks', 'sensual_delights', 'hammering_pounding_toys', 'women_s', 'dairy_eggs', 'houses', 'albums', 'sauces_dips', 'beef', 'breadsticks', 'health_care', 'carriers', 'party_mix', 'nut_clusters', 'teddy_bears', 'yo_yos', 'bathroom_safety', 'lips', 'hands_nails', 'pork_rinds', 'seafood_gifts', 'hair_color', 'coconut_water', 'daily_living_aids', 'ice_cream_frozen_desserts', 'dolls_accessories', 'sets', 'cheese', 'chocolate_gifts', 'electrical_safety', 'aquarium_stands', 'music_sound', 'hair_scalp_treatments', 'gym_sets_swings', 'play_tents_tunnels', 'changing_table_pads_covers', 'blasters_foam_play', 'molding_sculpting_sticks', 'finger_boards_finger_bikes', 'eggs', 'baby_child_care', 'breastfeeding', 'nutrition_wellness', 'game_room_games', 'floor_games', 'snack_gifts', 'activity_centers_entertainers', 'personal_care', 'novelties', 'handheld_games', 'jigsaw_puzzles', 'temporary_tattoos', 'pet_supplies', 'scooters_wagons', 'electronic_pets', 'sleep_snoring', 'stimulants', 'sexual_enhancers', 'body', 'sauces', 'rabbit_hutches', 'puffed_snacks', 'nails', 'gear', 'popcorn', 'dried_beans', 'eyes', 'grown_up_toys', 'fish_aquatic_pets', 'smoking_cessation', 'halva', 'trains_accessories', 'scaled_model_vehicles', 'spices_gifts', 'milk', 'games', 'styling_products', 'hair_relaxers', 'baby_food', 'first_aid', 'canned_jarred_food', 'food_coloring', 'pizza_crusts', 'pretzels', 'exercise_wheels', 'breadcrumbs', 'baby_seats', 'cereal', 'jams', 'shampoos', 'mathematics_counting', 'trail_mix', 'dessert_gifts', 'cabinet_locks_straps', 'sexual_wellness', 'breads_bakery', 'licorice', 'teethers', 'electronics_for_kids', 'thermometers', 'pegged_puzzles', 'standard_playing_card_decks', 'incontinence', 'diaper_changing_kits', 'sports', 'jelly_beans', 'step_stools', 'tea', 'portable_changing_pads', 'granola_trail_mix_bars', 'beads', 'dollhouses', 'lip_care_products', 'fresh_flowers_live_indoor_plants', 'chocolate_truffles', 'rocking_spring_ride_ons', 'craft_kits', 'hard_candies', 'gift_sets', 'wipes_holders', 'maternity_pillows', 'playsets', 'beds_accessories', 'blocks', 'cat_flaps', 'science', 'water_treatments', 'grocery_gourmet_food', 'dried_fruit_raisins', 'fruit_gifts', 'sugars_sweeteners', 'eye_care', 'snack_food', 'cocktail_mixers', 'breakfast_bakery', 'collars', 'water', 'lighters', 'sports_outdoor_play', 'aromatherapy', 'pogo_sticks_hoppers', 'drawing_sketching_tablets', 'tile_games', 'odor_stain_removers', 'joggers', 'fresh_cut_flowers', 'gifts', 'baby_gyms_playmats', 'crackers_biscuits', 'butter', 'automatic_feeders', 'd_puzzles', 'coatings_batters', 'gum', 'aquarium_hoods', 'gummy_candies', 'hair_loss_products', 'pill_cases_splitters', 'chocolate_covered_fruit', 'scrubs_body_treatments', 'pasta_noodles', 'seat_covers', 'wind_up_toys', 'fresh_baked_cookies', 'hot_cocoa', 'cleansers', 'training_pants', 'health_baby_care', 'action_toy_figures', 'backpacks_carriers', 'rockets', 'fresh_vegetables', 'candy_gifts', 'nail_tools', 'animals_figures', 'floor_puzzles', 'swings', 'spinning_tops', 'breads', 'miniatures', 'styling_tools', 'kitchen_safety', 'powdered_drink_mixes', 'harnesses_leashes', 'oils', 'magic_kits_accessories', 'conditioners', 'seafood', 'health_monitors', 'cough_cold', 'ear_care', 'braces', 'nesting_dolls', 'pain_relievers', 'bathing_tubs_seats', 'pastries', 'clay_dough', 'sauces_gifts', 'granola_bars', 'plug_play_video_games', 'baby_products', 'money_banks', 'food', 'beauty_fashion', 'card_games', 'teaching_clocks', 'lamb', 'candy_chocolate', 'cleaners', 'kites_wind_spinners', 'sugar_substitutes', 'foot_care', 'nuts_seeds', 'learning_education', 'stacking_blocks', 'diabetes', 'coffee_gifts', 'tricycles', 'puppets', 'dinners', 'beauty', 'easels', 'produce', 'treats', 'solid_feeding', 'slime_putty_toys', 'wild_game_fowl', 'car_seat_stroller_toys', 'sandboxes_accessories', 'carriers_strollers', 'pillows_stools', 'beverages', 'energy_drinks', 'dance_mats', 'pastry_decorations', 'adult_toys_games', 'toy_banks', 'non_slip_bath_mats', 'exotic_meats', 'bubble_bath', 'pretend_play', 'salsas', 'cotton_swabs', 'balls', 'litter_housebreaking', 'syrups', 'marble_games', 'toys_games', 'household_cleaning', 'blackboards_whiteboards', 'sand_water_tables', 'sun_protection', 'furniture', 'pantry_staples', 'bathing_accessories', 'cleaning_tools', 'sports_drinks', 'mints', 'chewing_gum', 'houses_habitats', 'bars', 'taffy', 'crackers', 'shopping_cart_covers', 'pregnancy_maternity', 'herbs', 'hair_nails', 'meat_gifts', 'monitors', 'chips_crisps', 'test_kits', 'packaged_meals_side_dishes', 'hobbies', 'push_pull_toys', 'coin_collecting', 'toffee', 'plush_backpacks_purses', 'standard', 'tandem', 'dessert_toppings', 'dice_gaming_dice', 'fudge', 'breeding_tanks', 'household_batteries', 'face', 'shape_sorters', 'potty_training', 'jerky_dried_meats', 'model_building_kits_tools', 'weight_loss_products', 'figures', 'disposable_diapers', 'laundry', 'flours_meals', 'p_t_s', 'meat_poultry', 'trading_card_games', 'live_indoor_plants', 'men_s', 'walkers', 'bathing_skin_care', 'tea_gifts', 'coffee', 'tests', 'statues', 'feminine_care', 'makeup_sets', 'battling_tops', 'keepsakes', 'breakfast_foods', 'diapering', 'shaving_hair_removal', 'oral_hygiene', 'dishwashing', 'electronics', 'cloth_diapers', 'digestion_nausea', 'extracts_flavoring', 'viewfinders', 'die_cast_vehicles', 'alternative_medicine', 'condiments', 'novelty_gag_toys', 'diaper_stackers_caddies', 'outdoor_safety', 'board_games', 'music_players_karaoke', 'deodorants_antiperspirants', 'lightweight', 'fresh_fruits', 'sleep_positioners', 'aquarium_d_cor', 'printing_stamping', 'children_s', 'beanbags_foot_bags', 'indoor_climbers_play_structures', 'bath_toys', 'massage_relaxation', 'feeding_watering_supplies', 'aquarium_lights', 'bacon', 'car_seats', 'hair_care', 'building_toys', 'car_seats_accessories', 'grooming_healthcare_kits', 'toys', 'basic_life_skills_toys', 'strollers', 'makeup', 'arts_crafts', 'plush_puppets', 'jerky', 'stuffing', 'baking_mixes', 'bunny_rabbit_central', 'occupational_physical_therapy_aids', 'toy_gift_sets', 'habitats', 'activity_play_centers', 'chocolate_bars', 'slot_cars', 'marshmallows', 'play_vehicles', 'chocolate_covered_nuts', 'juices', 'soft_drinks', 'flying_toys', 'pools_water_fun', 'fruits', 'stacking_games', 'training_behavior_aids', 'drawing_painting_supplies', 'washcloths_towels', 'playards', 'health_supplies', 'cloth_diaper_accessories', 'makeup_brushes_tools', 'assortments', 'game_collections', 'potties_seats', 'cages', 'bottle_feeding', 'memorials', 'raisins', 'aquarium_starter_kits', 'facial_steamers', 'aquarium_heaters', 'apparel_accessories', 'travel_games', 'shampoo', 'cooking_baking_supplies', 'novelty_spinning_tops', 'mobility_aids_equipment', 'dolls', 'paper_plastic', 'doors', 'meat_seafood', 'skin_care', 'plush_pillows', 'rice_cakes', 'dress_up_pretend_play', 'beds_furniture', 'dogs', 'stress_reduction', 'pumps_filters', 'systems_accessories', 'fragrance', 'doll_accessories', 'cameras_camcorders', 'fitness_equipment', 'chocolate_pretzels', 'vitamins_supplements', 'cakes', 'chips', 'electronic_toys', 'sports_supplements', 'building_sets', 'fish_bowls', 'bondage_gear_accessories', 'safer_sex', 'mirrors', 'toy_balls', 'chocolate_assortments', 'dollhouse_accessories', 'toaster_pastries', 'cookies', 'reading_writing', 'cages_accessories', 'diaper_bags', 'edge_corner_guards', 'hair_coloring_tools', 'stuffed_animals_plush', 'women_s_health', 'gummy_candy', 'accessories', 'cereals', 'cheese_gifts', 'family_planning_contraceptives', 'birds', 'tortillas', 'bath_body', 'brain_teasers', 'health_personal_care', 'dvd_games', 'makeup_remover', 'sun', 'prisms_kaleidoscopes', 'prams', 'pudding', 'therapeutic_skin_care', 'thermometer_accessories', 'chocolate', 'hydrometers', 'baking_powder', 'chicken', 'play_trains_railway_sets', 'die_cast_toy_vehicles', 'slumber_bags', 'shampoo_plus_conditioner', 'personal_video_players_accessories', 'stickers', 'sex_furniture', 'gag_toys_practical_jokes', 'ball_pits_accessories', 'maternity', 'dried_fruit', 'geography', 'dips', 'vehicle_playsets', 'household_supplies', 'suckers_lollipops', 'nutrition_bars_drinks', 'puzzle_play_mats', 'caramels', 'grooming', 'nursery', 'highchairs_booster_seats', 'pacifiers_accessories', 'bedding', 'cats', 'bathroom_aids_safety', 'inflatable_bouncers', 'body_art', 'stuffed_animals_toys', 'baby_formula', 'foie_gras_p_t_s', 'milk_substitutes', 'puzzles', 'puzzle_accessories', 'walkie_talkies', 'soaps_cleansers', 'diaper_pails_refills', 'gates_doorways', 'gourmet_gifts', 'nursery_d_cor', 'spices_seasonings', 'fruit_leather', 'carriers_travel_products', 'radio_control']


EUR_topics = ['1477', '4095', '6212', '4704', '6155', '1207', '7985', '1552', '121', '5852', '4018', '4051', '451069', '6822', '2713', '3413', '1782', '1841', '1907', '2404', '2185', '1915', '3866', '4527', '2557', '1611', '2169', '8410', '602', '486', '4608', '2872', '3385', '6210', '1737', '5877', '4528', '3374', '2972', '3635', '2128', '1994', '1363', '298', '4234', '3724', '931', '1828', '4348', '4020', '296', '5573', '5309', '1878', '7950', '2331', '1025', '1343', '1491', '1900', '2455', '1565', '2984', '4565', '6562', '5951', '141', '1527', '2948', '1238', '2458', '1086', '3932', '3071', '4540', '4316', '1775', '3844', '2277', '3927', '301', '1834', '3160', '4613', '1532', '4689', '3412', '5272', '3065', '1280', '1768', '2292', '1388', '3800', '2820', '1163', '2474', '5330', '3636', '1839', '5217', '2847', '1702', '1588', '2992', '4271', '4371', '1613', '4474', '1087', '92', '392', '2956', '6130', '561', '182', '1867', '2604', '500', '3774', '665', '3103', '3072', '3506', '5424', '3099', '5582', '7137', '1911', '6099', '3278', '3514', '4582', '3637', '2775', '245', '3649', '2289', '3653', '1202', '2266', '6902', '1776', '2110', '3667', '2560', '4498', '3428', '3948', '1355', '2119', '6356', '4465', '2794', '1294', '3666', '2121', '1755', '4092', '5879', '3077', '6335', '5408', '140', '3083', '4437', '3795', '3869', '2845', '2373', '1873', '2642', '5519', '1856', '1826', '2684', '5206', '5794', '3917', '156', '8476', '3075', '1199', '1752', '1906', '1435', '6927', '1560', '2303', '8308', '6055', '614', '5802', '4782', '3669', '2712', '1986', '6084', '5858', '1234', '204', '2601', '1254', '8310', '6274', '1748', '1513', '523', '3745', '311', '868', '6025', '1035', '5312', '3171', '3148', '2912', '451885', '2674', '3959', '5515', '192', '1365', '809', '2821', '5010', '3060', '3475', '3400', '3560', '2746', '4034', '262', '5088', '1287', '1317', '8475', '2325', '3613', '2868', '4127', '4774', '3780', '1465', '2859', '4579', '1262', '5462', '2158', '2371', '2870', '6567', '2487', '142', '2056', '735', '530', '4258', '5155', '215', '4412', '2156', '4037', '3647', '1433', '5927', '388', '3169', '4828', '436', '396', '5697', '766', '5093', '7202', '2773', '3942', '865', '1524', '2637', '1220', '3558', '2386', '1761', '8464', '472', '2568', '723', '2078', '3196', '5341', '1077', '2570', '316', '2505', '434843', '2470', '603', '4671', '1122', '833', '913', '5746', '94', '2481', '2849', '4630', '5270', '4518', '1671', '381', '2690', '211', '496', '1637', '2858', '112', '3642', '4383', '2877', '197', '1918', '5532', '4295', '63', '8281', '818', '1362', '1360', '3334', '5729', '2521', '4143', '4447', '3767', '3405', '2363', '4857', '1268', '2832', '4531', '6407', '2421', '1209', '6031', '7977', '6855', '3109', '1501', '5652', '4046', '1275', '3422', '3300', '6774', '481', '4256', '1056', '717', '5651', '1949', '3272', '2704', '6369', '1503', '6767', '2126', '5396', '4374', '6262', '5226', '5237', '2976', '5483', '2453', '3660', '2986', '2387', '209', '167', '1799', '5187', '1111', '2689', '6152', '2516', '2425', '3880', '3446', '2151', '4793', '2625', '2084', '3757', '2975', '4824', '5352', '3502', '3325', '4381', '1959', '1174', '439592', '2727', '4720', '6700', '1364', '3209', '867', '919', '89', '4585', '1650', '5909', '6089', '6188', '3793', '5365', '1549', '3898', '5130', '4010', '5627', '11', '2900', '1037', '2659', '2472', '3345', '5075', '3053', '690', '3673', '945', '80', '736', '7841', '4078', '4856', '4070', '4074', '5618', '3228', '1031', '416', '3551', '1445', '2869', '4402', '1577', '2599', '3162', '6007', '5463', '4983', '2643', '3634', '886', '2838', '838', '4159', '3510', '8316', '899', '5601', '6189', '4649', '513', '1838', '2545', '5752', '1423', '1933', '1383', '351', '5448', '5293', '304', '2830', '1164', '6747', '3151', '1667', '2019', '2105', '4281', '1968', '5647', '6060', '1509', '3491', '157', '1139', '3119', '3581', '2500', '1675', '3846', '2403', '3685', '909', '3710', '969', '1456', '8478', '3469', '2907', '542', '5456', '5029', '4097', '3936', '703', '2556', '233', '1919', '1847', '2670', '2591', '5856', '5810', '5578', '1335', '4478', '320', '1088', '2982', '5438', '91', '3531', '1728', '3166', '7941', '935', '1229', '6704', '3873', '3854', '5769', '2809', '75', '1718', '812', '4068', '2040', '5675', '4448', '3191', '2131', '6892', '2163', '2026', '2860', '3727', '2564', '2356', '1871', '1612', '5322', '4309', '3809', '1950', '2577', '4750', '5560', '3507', '2614', '989', '2549', '2306', '5585', '1780', '4237', '3737', '5413', '4136', '5503', '4505', '2806', '5823', '5212', '5247', '2791', '2881', '2960', '609', '461', '1310', '3363', '3155', '2166', '725', '3855', '2278', '2499', '4300', '5376', '4692', '430', '6202', '5327', '50', '2694', '1237', '5904', '743', '3057', '2692', '5037', '4187', '40', '3651', '1452', '4743', '3929', '458', '1434', '1846', '4493', '3390', '409', '2023', '4286', '4714', '4658', '5182', '2290', '699', '555', '5257', '15', '4809', '4653', '1937', '5387', '1393', '4640', '189', '6788', '5786', '3359', '5566', '968', '1154', '3534', '5622', '411', '2748', '1442', '2839', '6257', '1447', '2057', '3671', '73', '3397', '2737', '3021', '3139', '2449', '6903', '5761', '2305', '4155', '3843', '2522', '1357', '5059', '2629', '697', '3801', '2890', '4722', '3127', '5816', '3895', '7944', '5586', '2950', '4003', '729', '2459', '6626', '1887', '2415', '6332', '2041', '6569', '3393', '5989', '1235', '5956', '5297', '434004', '1303', '4398', '3678', '2701', '97', '463', '3307', '5876', '1377', '3204', '2498', '1333', '1534', '3453', '2214', '4160', '5152', '1394', '397', '3152', '538', '2063', '1322', '758', '5275', '4196', '2902', '3310', '7353', '3348', '2247', '3483', '4162', '3236', '2433', '4690', '6038', '2173', '4310', '5205', '4025', '2345', '1566', '492', '2683', '4506', '2476', '248', '5689', '1300', '3454', '5964', '3357', '1464', '303', '5373', '5092', '435', '2291', '7133', '8336', '194', '1553', '773', '1265', '2622', '5696', '2059', '1426', '1522', '3010', '1000', '5343', '5511', '3888', '785', '4771', '5409', '4509', '4122', '3275', '1252', '2125', '3544', '3773', '2444', '564', '5371', '4285', '8465', '3381', '3861', '1957', '795', '2232', '3863', '1439', '5334', '5232', '5800', '4507', '6373', '350', '3143', '353', '8307', '2058', '1634', '2938', '5738', '768', '7927', '1652', '1279', '2739', '3533', '2785', '4028', '5277', '1007', '5787', '55', '4333', '448275', '535', '2638', '3585', '4838', '2175', '4843', '4423', '2777', '3574', '5590', '1204', '1248', '4158', '5751', '2320', '2409', '940', '1428', '1791', '4393', '4503', '5120', '2478', '3024', '678', '1460', '6699', '2307', '2672', '4575', '741', '2436', '5509', '3248', '920', '4577', '859', '5191', '4435', '283', '1178', '2298', '2518', '6723', '497', '2149', '2705', '1476', '4217', '8542', '2139', '1309', '915', '3620', '3812', '3753', '85', '957', '3798', '2805', '2681', '3783', '1284', '3218', '4430', '1349', '4637', '5016', '477', '2661', '1216', '1195', '5044', '3205', '4819', '1877', '222', '5763', '6021', '2512', '1099', '2896', '146', '6139', '2754', '2099', '4049', '3013', '5774', '1440', '2429', '1039', '8386', '2483', '47', '2656', '4056', '1130', '2440', '1872', '2695', '2974', '169', '4563', '4742', '1100', '8428', '2435', '5299', '4426', '5267', '1766', '6029', '2779', '4511', '2224', '3287', '1934', '1819', '1027', '1894', '4789', '6260', '3628', '2851', '1008', '1304', '4378', '2635', '3782', '1645', '3175', '1404', '2241', '4660', '511', '1038', '3946', '1639', '1129', '178', '2296', '554', '6850', '6350', '218', '5320', '5985', '2916', '1892', '4171', '4705', '5329', '5914', '1114', '2286', '2711', '3943', '2184', '479', '1863', '755', '2457', '5369', '1557', '86', '2833', '2636', '4294', '510', '138', '5301', '3404', '1732', '56', '4441', '1777', '3164', '6198', '4654', '1381', '2198', '4290', '171', '6913', '1570', '383', '2932', '4047', '7130', '4369', '4410', '4006', '3329', '4184', '5847', '5874', '5640', '3289', '2420', '5561', '4717', '1422', '4470', '642', '4366', '4650', '2243', '1256', '484', '1326', '1387', '2657', '3106', '4181', '5454', '1754', '2914', '4043', '1974', '5969', '1860', '3073', '2297', '4045', '3820', '4558', '1446', '3526', '6713', '3865', '532', '5818', '2898', '1665', '3570', '4266', '2524', '4250', '1913', '3076', '2550', '5888', '1676', '5910', '6379', '6276', '778', '3283', '6911', '1832', '5820', '5954', '2054', '628', '2807', '4208', '5676', '4707', '1298', '4016', '3501', '6095', '1382', '4881', '3926', '3051', '170', '1201', '2318', '1458', '5520', '2494', '5559', '4680', '4576', '2922', '4260', '345', '3187', '1315', '5405', '2497', '2230', '4411', '811', '3600', '1833', '5643', '1389', '2467', '394', '259', '3859', '447756', '1633', '3538', '3207', '5606', '2517', '4180', '2581', '2699', '4182', '5809', '4219', '5719', '1688', '225', '4765', '4215', '1070', '4657', '688', '1604', '7968', '3882', '1616', '3346', '1369', '3790', '3663', '3532', '6135', '5741', '3108', '978', '1134', '5925', '3995', '1743', '2052', '7980', '447660', '442791', '3273', '1641', '619', '6917', '767', '5246', '691', '5245', '2647', '5968', '2634', '5274', '5971', '4345', '3578', '2328', '3090', '3430', '2451', '5742', '6709', '1668', '4387', '6776', '4632', '3176', '5136', '2755', '4352', '433963', '3543', '1425', '1738', '4823', '4790', '2324', '4232', '1152', '3768', '2050', '2829', '116', '4083', '25', '5461', '1233', '3692', '3857', '2376', '3693', '4148', '2606', '7975', '5105', '4612', '5650', '2484', '1807', '3672', '53', '3741', '3259', '5043', '1372', '588', '1672', '3180', '1217', '5464', '1803', '239', '5176', '174', '20', '2157', '3098', '42', '3466', '1848', '391', '4084', '2871', '5587', '3682', '536', '6196', '1416', '605', '2747', 'c_871b5612', '4303', '2075', '4248', '4365', '5047', '506', '5845', '3032', '3480', '6061', '2028', '1731', '2383', '613', '692', '4322', '1050', '5700', '1655', '1642', '3811', '765', '730', '4038', '1854', '4966', '2062', '525', '2431', '4380', '5032', '5045', '5920', '39', '3639', '4268', '2359', '1208', '3264', '1455', '6619', '2936', '2901', '5439', '993', '4515', '3805', '3047', '1973', '3860', '4602', '4314', '1492', '195', '1182', '760', '329', '1200', '1496', '5072', '3424', '3105', '5528', '4854', '2462', '7942', '709', '3299', '5287', '114', '93', '256', '3351', '2111', '4696', '4274', '491', '999', '4821', '5609', '3369', '8284', '161', '2911', '2537', '4359', '5469', '5726', '981', '447795', '54', '2610', '5745', '5768', '241', '5595', '4291', '871', '843', '84', '4849', '3849', '450658', '2511', '4539', '4224', '3362', '1762', '5335', '618', '897', '1475', '6264', '2378', '718', '1708', '5426', '2989', '4492', '2612', '2653', '2745', '4304', '5031', '4724', '3876', '604', '380', '6051', '5734', '440', '6192', '5617', '4179', '5318', '2937', '2442', '5150', '4432', '1530', '128', '6320', '2336', '5308', '798', '276', '4404', '6040', '2520', '4377', '5608', '1054', '5499', '3387', '1885', '324', '4863', '6045', '322', '2627', '3291', '4035', '4276', '2027', '1842', '3759', '5502', '5235', '340', '4485', '1771', '4542', '6298', '6899', '2540', '973', '467', '4424', '155', '3163', '1311', '2413', '3002', '2138', '3589', '3814', '3447', '6108', '3070', '2758', '2133', '1142', '1370', '3181', '3', '1724', '2231', '626', '5368', '2515', '1378', '4631', '5127', '837', '4734', '57', '2468', '4126', '2802', '3039', '7136', '435196', '927', '757', '4264', '13', '4375', '6714', '6340', '180', '5248', '2621', '3409', '4178', '5944', '2649', '1729', '569', '2182', '1028', '451912', '1159', '6269', '3764', '3597', '5048', '1331', '5236', '1680', '5406', '3704', '5303', '5500', '3135', '2666', '6150', '2707', '4190', '5574', '552', '932', '5410', '5880', '7193', '3722', '5907', '3792', '3913', '5208', '3153', '69', '1332', '3438', '4763', '1624', '6541', '2827', '4420', '2588', '5104', '2366', '342', '99', '6146', '2828', '5937', '1059', '5123', '2772', '1206', '3227', '6623', '4080', '2393', '7879', '1510', '2548', '1516', '2338', '3434', '9', '2285', '4618', '306', '2221', '4818', '1759', '2095', '3326', '5815', '4401', '4568', '2465', '5865', '2706', '596', '3616', '2781', '2955', '2626', '2447', '4620', '827', '912', '2842', '1258', '6191', '2061', '3643', '2823', '4022', '2364', '4172', '2295', '5841', '3472', '1183', '3955', '4666', '1840', '5087', '1073', '371', '2162', '695', '1277', '3537', '1756', '942', '2988', '318', '2685', '4361', '2541', '2547', '1958', '3304', '1991', '2293', '3825', '372', '5970', '3048', '1893', '7199', '4112', '1490', '3117', '3468', '2308', '4600', '3286', '4257', '1339', '4347', '377', '420', '5780', '3572', '1899', '3194', '2248', '1354', '6048', '3896', '3386', '5151', '4461', '3813', '3971', '3140', '1635', '3034', '6621', '4099', '5017', '2208', '2795', '1981', '1117', '82', '1047', '3006', '997', '64', '4130', '2817', '1575', '1269', '431', '544', '2619', '5547', '434880', '4673', '5884', '1788', '5615', '5256', '4921', '1128', '5506', '6256', '2826', '4571', '4152', '5988', '2302', '3617', '3713', '5736', '2187', '916', '3776', '1545', '4788', '2680', '4553', '2329', '4186', '3449', '5827', '1108', '7855', '5923', '5890', '1820', '2066', '3403', '4457', '127', '4578', '6110', '4071', '3489', '1340', '1964', '1474', '1236', '2655', '2799', '3567', '1632', '2274', '2767', '1902', '4892', '3093', '1852', '1712', '2971', '1661', '4769', '1151', '3518', '592', '6268', '2891', '3974', '1896', '4265', '5099', '2360', '6325', '1161', '4885', '3760', '2153', '1631', '2954', '7982', '7351', '1168', '1468', '814', '4203', '3280', '1640', '6042', '2724', '1352', '2354', '3100', '8477', '8285', '5725', '1101', '5630', '2411', '5811', '3295', '4767', '8434', '3064', '3309', '3827', '6057', '2726', '5889', '3703', '3631', '4748', '3159', '568', '6016', '4726', '5364', '227', '3455', '8366', '5580', '115', '5770', '6851', '6111', '362', '2923', '5241', '1787', '5645', '6049', '3461', '2390', '816', '1390', '4360', '3563', '1622', '5936', '1165', '5419', '6039', '4648', '1227', '8411', '3614', '3231', '5772', '336', '738', '5445', '5460', '1542', '906', '2759', '7873', '2273', '5122', '4785', '344', '3217', '2709', '1594', '5859', '3916', '668', '6222', '8549', '5317', '3460', '3841', '2450', '3129', '4055', '3220', '5139', '3789', '508', '1177', '4191', '5315', '712', '3085', '4656', '1063', '4128', '806', '4628', '2679', '5050', '3378', '2234', '3174', '5797', '704', '3549', '7', '5555', '5482', '4817', '5421', '3656', '960', '4597', '51', '3398', '3751', '302', '1110', '3584', '4825', '2309', '1241', '5974', '4438', '2060', '5407', '745', '5540', '4746', '187', '6296', '3316', '5938', '1172', '4418', '8547', '6398', '3528', '5784', '3559', '4462', '2400', '4476', '4193', '3837', '2757', '214', '5451', '2226', '4357', '529', '2407', '4131', '3154', '1395', '2933', '842', '7818', '1590', '1486', '5381', '139', '3918', '2493', '1156', '314', '3556', '2155', '3330', '3371', '2594', '4335', '3178', '7954', '5243', '3908', '1043', '4745', '1085', '4065', '1396', '4346', '389', '2204', '1384', '946', '2144', '4526', '4733', '4409', '2917', '2358', '3748', '3804', '1313', '449', '1700', '6775', '3477', '5363', '2668', '202', '2473', '2255', '5922', '7837', '7815', '786', '313', '1941', '4306', '5926', '6067', '3513', '5400', '622', '5138', '12', '1687', '972', '4497', '2430', '4878', '2456', '5598', '4472', '1811', '2780', '5749', '2798', '5019', '1196', '1810', '2641', '5314', '3516', '4328', '208', '3739', '231', '1060', '3561', '1529', '4002', '454', '926', '5239', '2349', '1971', '2741', '5251', '6004', '5234', '1558', '710', '1004', '831', '4015', '4220', '325', '3749', '4298', '1663', '1485', '4721', '3165', '6036', '5351', '4810', '5238', '5372', '5619', '4170', '4005', '4403', '6897', '3200', '1518', '970', '2256', '5025', '1726', '3253', '3568', '5632', '870', '2525', '599', '260', '1822', '1989', '5290', '6019', '6824', '1123', '1837', '3001', '1219', '5785', '3604', '1015', '274', '5796', '1373', '4806', '2042', '3061', '2150', '71', '5563', '2469', '5157', '6012', '534', '2892', '5891', '2410', '5374', '826', '5757', '4900', '1072', '4417', '5908', '5905', '1562', '860', '2602', '4085', '6763', '1240', '439498', '3688', '4288', '5760', '1057', '3384', '6263', '3912', '4536', '3084', '5172', '1883', '5310', '5790', '4845', '1356', '2906', '1559', '5994', '3576', '5871', '1026', '8459', '2479', '474', '3522', '1398', '5073', '4350', '2929', '6197', '4883', '1397', '3101', '1288', '5201', '1328', '4167', '2834', '3452', '5218', '4211', '5753', '5225', '3934', '1568', '2471', '2008', '3924', '5792', '1606', '895', '3185', '111', '4395', '2191', '2645', '1036', '1870', '6852', '4279', '1882', '2240', '5895', '5022', '2427', '2789', '2943', '2765', '6128', '5258', '922', '4382', '1979', '4139', '5550', '6787', '5271', '2897', '2267', '6727', '2979', '5181', '3133', '1106', '4247', '1367', '6375', '2774', '1813', '4747', '3632', '2093', '879', '884', '3521', '4729', '5522', '7931', '6054', '2730', '2742', '2658', '3463', '4354', '4773', '664', '5642', '5930', '236', '5534', '3120', '357', '83', '5705', '5126', '3206', '77', '711', '6725', '3988', '2961', '5713', '924', '2771', '5263', '1554', '3331', '1012', '365', '5775', '1734', '4665', '606', '179', '763', '3131', '7843', '442', '87', '4236', '2958', '2783', '3179', '2698', '2408', '5584', '2563', '287', '7868', '707', '680', '4860', '5903', '2437', '953', '3011', '3655', '5765', '327', '5112', '426', '2963', '700', '4731', '5860', '5230', '2720', '473', '3661', '1617', '6316', '3201', '1266', '5512', '476', '1290', '5545', '1619', '4204', '1888', '2193', '4175', '6011', '720', '3388', '1487', '2824', '2840', '3919', '3618', '2921', '3718', '4781', '2350', '7817', '4315', '240', '1189', '1685', '5992', '597', '4496', '312', '289', '6710', '44', '1158', '4307', '1988', '3017', '548', '5739', '3367', '4239', '2998', '1125', '2535', '3862', '1143', '4273', '1741', '5993', '5806', '368', '1638', '2970', '5199', '4246', '4364', '849', '1969', '2991', '2743', '6050', '4479', '2994', '1654', '1273', '438', '1876', '3156', '2676', '742', '123', '841', '295', '7198', '2399', '2202', '566', '3033', '3251', '4081', '2438', '5028', '6124', '8279', '2763', '5548', '1514', '1462', '1230', '2662', '2925', '220', '2088', '8469', '2640', '2790', '3879', '1520', '764', '4884', '3016', '201', '1528', '4798', '2509', '1997', '6112', '1719', '2055', '1185', '6216', '6223', '4676', '5782', '4312', '923', '3633', '4455', '5228', '1302', '5562', '172', '2394', '4886', '5273', '4318', '2141', '1361', '2375', '3870', '1591', '1561', '835', '2725', '911', '574', '4337', '6404', '2377', '3462', '898', '5861', '3353', '2843', '427', '5536', '2749', '1853', '6103', '6252', '1267', '3777', '1576', '4416', '581', '268', '7126', '3596', '4687', '408', '2115', '788', '3450', '2578', '4831', '2300', '3816', '2396', '5844', '3317', '5470', '150', '6360', '815', '2928', '4562', '1438', '1295', '744', '1965', '2831', '1083', '5354', '4177', '5021', '3594', '985', '2025', '5458', '1972', '5848', '1431', '1623', '876', '5887', '2482', '3961', '3145', '3890', '5694', '2039', '4449', '1124', '3885', '4292', '6194', '2504', '1952', '2595', '385', '3336', '4388', '7813', '2045', '4530', '2962', '5535', '2644', '4514', '219', '2864', '5209', '1701', '6402', '3970', '3664', '799', '5868', '1538', '2552', '6361', '3836', '414', '656', '990', '563', '3306', '5872', '3577', '4431', '4635', '2715', '5086', '3308', '5613', '4044', '650', '5491', '4638', '3595', '4486', '5814', '4059', '1052', '5579', '3732', '10', '6777', '4930', '638', '1512', '1864', '2879', '2199', '5840', '3451', '6064', '4663', '1786', '3806', '1537', '4', '2528', '4384', '2732', '857', '3535', '875', '4362', '3429', '4847', '4050', '3504', '4031', '3338', '7840', '35', '1589', '6200', '3074', '4308', '4163', '2579', '1630', '2129', '2382', '275', '3778', '446', '3590', '6821', '285', '6249', '5824', '1406', '2565', '3701', '5359', '3803', '1643', '8462', '4332', '2189', '5300', '1190', '2782', '2269', '4480', '2527', '252', '34', '5447', '5415', '1816', '4524', '2990', '3952', '1814', '3382', '2137', '889', '1607', '3770', '1519', '5063', '4284', '1651', '2735', '1804', '2608', '3905', '6370', '5897', '2136', '6308', '3377', '483', '8357', '3605', '6790', '2426', '5375', '1386', '7410', '5953', '7986', '5467', '3743', '5812', '4062', '2466', '3878', '5756', '956', '4329', '5885', '5284', '3842', '3881', '4141', '1249', '903', '1232', '2769', '5411', '5253', '5902', '1403', '6100', '4646', '7208', '1909', '2460', '832', '6043', '1444', '1523', '1255', '1239', '4014', '6347', '8301', '2246', '5864', '1500', '221', '7864', '2886', '3968', '4379', '1774', '770', '2761', '4453', '7131', '5240', '2416', '928', '4691', '3130', '2206', '5900', '4839', '3350', '848', '2014', '403', '6008', '3490', '3086', '402', '3691', '4213', '1330', '5091', '5537', '2279', '864', '1595', '2222', '1432', '4732', '188', '3052', '6013', '1366', '399', '1119', '433', '5472', '2825', '310', '1484', '941', '6333', '2113', '4718', '4614', '5777', '4331', '1301', '1191', '573', '469', '2624', '5886', '5898', '249', '2744', '1563', '3579', '2609', '1488', '247', '2952', '726', '3324', '1750', '5870', '1879', '1133', '6786', '7951', '5766', '1225', '715', '2571', '1742', '6920', '4584', '1521', '3679', '5966', '6904', '2816', '3815', '3049', '828', '6401', '4533', '3765', '3868', '1076', '6919', '6411', '3557', '5024', '2217', '2887', '891', '2082', '888', '5158', '5826', '4738', '504', '2924', '447917', '2682', '4984', '4259', '5219', '2178', '7221', '1385', '2098', '3624', '4422', '3874', '1904', '4741', '435164', '2918', '5648', '728', '2664', '2740', '3623', '3891', '226', '2810', '3983', '1778', '5932', '722', '3892', '4551', '584', '1283', '5042', '1231', '521', '2043', '36', '5382', '3575', '4225', '4639', '2646', '5672', '5946', '4780', '611', '3839', '1849', '5190', '2801', '2299', '1802', '5693', '1993', '3069', '4661', '5832', '164', '5588', '5298', '1109', '1961', '5383', '5427', '825', '2519', '851', '267', '442821', '2236', '7935', '1730', '323', '571', '158', '5762', '976', '3443', '6789', '1116', '1711', '6195', '1274', '753', '8452', '7814', '4636', '5307', '2965', '1800', '1945', '2616', '754', '4716', '2751', '988', '4834', '5360', '3254', '4342', '2628', '5728', '5935', '5899', '775', '2275', '5943', '5583', '5414', '4176', '6056', '5389', '1104', '2639', '3648', '7966', '2395', '2999', '246', '5192', '3323', '4075', '2337', '4667', '1418', '3420', '6322', '5455', '1704', '3711', '5283', '1392', '2753', '1757', '217', '6912', '5362', '6271', '3107', '1881', '5252', '2489', '4110', '4730', '2507', '1247', '3733', '2910', '1079', '5193', '4053', '5109', '5855', '3415', '5776', '1499', '1720', '6076', '2734', '4390', '2723', '3965', '3495', '6701', '2229', '2123', '213', '6371', '26', '4036', '635', '2047', '3043', '2888', '6609', '6044', '4643', '894', '7132', '2159', '1329', '1144', '4351', '4644', '7816', '1210', '4218', '282', '299', '1495', '6410', '933', '3028', '3944', '1113', '771', '3046', '3441', '1091', '4775', '3875', '2542', '4801', '575', '5124', '850', '5997', '5344', '3408', '4880', '4521', '4560', '801', '5593', '1666', '6047', '3771', '1459', '6547', '6059', '3030', '1773', '3189', '4376', '2893', '1821', '1399', '5259', '5473', '2319', '132', '822', '1767', '4836', '2439', '2719', '4185', '6922', '1618', '5049', '2270', '986', '4076', '5501', '3481', '5767', '2282', '28', '4605', '2951', '4588', '2836', '6121', '3008', '5543', '5231', '4827', '2448', '1851', '5106', '2587', '2304', '3731', '5649', '3735', '810', '560', '1716', '2688', '1078', '4877', '5313', '4165', '290', '2018', '2443', '1598', '3471', '965', '4475', '5743', '3893', '4532', '5933', '4812', '3068', '5289', '3122', '2502', '254', '3665', '2284', '4238', '6173', '1801', '5754', '5740', '853', '386', '4891', '6559', '3113', '6288', '5498', '2357', '4668', '3928', '5554', '3055', '5575', '3144', '3321', '5556', '8384', '5018', '1946', '1772', '4752', '199', '802', '1410', '1843', '4087', '4063', '6749', '1953', '2786', '3756', '6628', '176', '5866', '4452', '5186', '7937', '840', '4468', '437422', '3394', '3897', '4700', '5146', '8282', '5862', '2837', '3864', '450652', '343', '6046', '424', '5108', '1497', '6343', '3216', '5465', '1103', '3967', '3717', '2728', '943', '4109', '3840', '6907', '3111', '1348', '4189', '7956', '1379', '1010', '5062', '5356', '1411', '434966', '3026', '3031', '4682', '30', '3883', '5673', '2130', '4791', '5945', '5095', '2908', '5873', '154', '3263', '5508', '4861', '435330', '3003', '434938', '1585', '502', '5035', '1011', '2089', '7936', '1874', '2927', '3598', '1686', '173', '1564', '5185', '2590', '1327', '1898', '624', '5012', '4522', '4442', '4088', '3342', '5392', '8433', '1102', '737', '2069', '5140', '3654', '2077', '5350', '7875', '4695', '2804', '2733', '4227', '3611', '443', '2258', '4467', '2768', '4675', '1127', '3903', '4621', '4399', '4520', '62', '998', '1769', '1413', '2648', '4392', '235', '1197', '3474', '5958', '1596', '4572', '951', '1188', '2882', '3906', '6854', '333', '1603', '1827', '2068', '4262', '598', '6367', '3114', '441001', '435061', '5129', '1706', '1147', '8429', '1024', '4125', '1296', '6215', '3706', '3150', '4212', '2793', '4580', '6292', '2076', '2543', '5683', '2271', '2987', '3787', '2477', '1136', '143', '4519', '1019', '5429', '3769', '4197', '2414', '4370', '451486', '1074', '2615', '177', '4816', '1469', '4727', '5041', '3686', '4356', '3496', '1806', '4858', '2531', '3161', '797', '2176', '1796', '5039', '3730', '4567', '1812', '2862', '5262', '1250', '3659', '5149', '3545', '3258', '4057', '1690', '5156', '5695', '5324', '2611', '3320', '780', '1744', '4004', '2866', '2981', '3723', '632', '1955', '5730', '1401', '1884', '1723', '5597', '6930', '2212', '2311', '5292', '893', '1555', '4355', '3851', '3332', '4778', '2687', '944', '2496', '6400', '5014', '1405', '255', '281', '4512', '441716', '4324', '3125', '186', '1696', '2788', '3149', '5691', '61', '2211', '3834', '3261', '317', '1609', '452085', '687', '3784', '3391', '4425', '5433', '3246', '4115', '5541', '2623', '2464', '1567', '929', '830', '2108', '3170', '2287', '4195', '4146', '994', '3772', '3796', '3821', '5646', '1034', '5437', '2856', '4669', '4796', '4415', '3684', '5551', '1186', '8354', '1141', '5420', '885', '1029', '5306', '162', '4545', '4341', '4216', '2848', '5403', '2112', '7984', '3349', '4725', '1146', '936', '3355', '2143', '4317', '1939', '153', '1261', '2815', '5492', '1093', '3298', '4061', '979', '3641', '3288', '2909', '5596', '5896', '601', '1338', '1308', '4879', '4541', '7861', '3593', '3953', '4253', '2372', '7135', '1466', '3197', '1318', '5385', '4054', '1707', '60', '2301', '2589', '5291', '4116', '683', '5346', '4829', '5098', '2210', '6176', '2215', '995', '570', '4783', '5678', '1089', '4719', '4708', '7219', '4400', '6363', '309', '2352', '2312', '1586', '5710', '2850', '5188', '5477', '4042', '5680', '6923', '612', '2090', '1058', '4133', '2379', '2722', '1921', '2029', '4622', '5709', '2213', '4735', '212', '58', '3038', '5805', '623', '5210', '429', '417', '6916', '5798', '3822', '2539', '677', '2792', '2080', '33', '2013', '3830', '4488', '3173', '1602', '4627', '4502', '5892', '6151', '5671', '2913', '5825', '6163', '5723', '3650', '3004', '1402', '3252', '5282', '5090', '2488', '6306', '8454', '478', '2264', '2228', '4111', '2015', '4482', '6247', '5020', '6894', '3262', '2551', '6342', '3416', '8480', '930', '4715', '2012', '5367', '4129', '4728', '5040', '5542', '1167', '4842', '5525', '1763', '4289', '1140', '3365', '1342', '958', '4344', '1493', '4108', '4688', '5311', '980', '863', '3488', '4444', '2384', '315', '2567', '5610', '7395', '1797', '2067', '1795', '1615', '4021', '4841', '5716', '4082', '5504', '5581', '4397', '890', '5698', '4151', '4079', '4681', '3810', '829', '2002', '453', '294', '4559', '5096', '494', '819', '1334', '4808', '2402', '549', '4833', '3219', '914', '1285', '772', '2915', '3709', '4413', '5576', '834', '2218', '716', '800', '807', '2654', '2310', '3172', '2492', '1132', '1131', '925', '4557', '2081', '5078', '3832', '3370', '4830', '5431', '2696', '2766', '3826', '5183', '4662', '2428', '2800', '5552', '6307', '2718', '2883', '5605', '3193', '1714', '4320', '3920', '5771', '996', '1075', '5076', '3766', '2853', '3437', '2216', '1120', '1489', '4048', '5386', '4311', '3588', '539', '2321', '3401', '517', '1504', '3497', '5100', '616', '4166', '4674', '468', '2038', '3373', '5978', '4144', '1713', '3457', '4245', '4001', '5684', '8468', '820', '1880', '1316', '2686', '367', '6781', '6', '1983', '2760', '1193', '2355', '4548', '6703', '3871', '5399', '4017', '2281', '7218', '2957', '844', '462', '5294', '2406', '6706', '651', '6174', '4723', '5141', '4358', '4428', '586', '2501', '6201', '1069', '545', '2463', '5229', '1830', '4840', '5668', '2114', '6918', '2756', '3282', '3392', '3134', '5115', '5384', '1809', '5065', '1006', '5485', '6890', '625', '5791', '1653', '5833', '5634', '228', '1051', '3482', '2968', '3190', '3123', '846', '4499', '2561', '6366', '5819', '5962', '223', '3225', '3067', '1895', '2179', '5083', '8412', '4407', '5715', '2418', '3629', '3303', '308', '3239', '3933', '5361', '2220', '2605', '5744', '4338', '2944', '4491', '6756', '2083', '4779', '518', '6563', '6088', '4033', '6560', '5305', '1166', '5000', '2818', '5967', '6117', '823', '750', '475', '3824', '5883', '4105', '447958', '5546', '1868', '1218', '6755', '1857', '3681', '166', '488', '5166', '1891', '2417', '7932', '2651', '2333', '4113', '5843', '5255', '2729', '347', '1018', '2607', '557', '5589', '5842', '950', '7970', '4685', '5836', '4709', '2140', '3949', '4770', '648', '1415', '2368', '5972', '1927', '305', '1155', '4529', '1448', '5242', '3754', '774', '4313', '1107', '2884', '4117', '1935', '1095', '5261', '1960', '4672', '2969', '4405', '207', '5116', '1954', '5342', '2109', '4040', '862', '3097', '1779', '4000', '3823', '5750', '540', '756', '5513', '1531', '2526', '2562', '1792', '5570', '3887', '4210', '2580', '748', '878', '1030', '2947', '8423', '136', '1815', '4645', '3646', '5200', '1371', '724', '5839', '5636', '1424', '2863', '6052', '1346', '693', '5034', '6094', '321', '2432', '4619', '1253', '1670', '5304', '250', '1905', '4060', '5338', '1270', '3582', '2367', '2738', '610', '873', '3626', '646', '1584', '1375', '432', '5440', '4651', '4373', '3714', '8553', '3250', '1321', '1429', '4408', '284', '3565', '5223', '328', '1674', '5929', '1451', '2194', '59', '4490', '4385', '2920', '5917', '6884', '3000', '191', '110', '5328', '5450', '1662', '4777', '3937', '881', '6295', '105', '2731', '3115', '4427', '1427', '253', '2323', '6753', '1649', '4994', '918', '2966', '2985', '2362', '4066', '3638', '4270', '666', '45', '4330', '5571', '5051', '447', '210', '8481', '3856', '701', '5280', '869', '5033', '3411', '3244', '6140', '1374', '952', '3552', '3998', '1005', '1525', '5055', '4655', '3619', '6034', '2752', '2736', '519', '2288', '1021', '1505', '2538', '509', '8460', '2412', '1587', '264', '3116', '600', '6751', '3058', '68', '1421', '5288', '813', '1319', '1145', '2314', '4445', '4073', '1929', '4161', '387', '2181', '3094', '3797', '5965', '5336', '5706', '4372', '3547', '441', '4469', '6041', '3265', '4252', '3079', '3389', '4451', '185', '3269', '5077', '5169', '6315', '337', '5332', '288', '216', '6926', '1048', '3112', '1798', '5457', '5788', '3527', '6345', '435007', '1511', '1115', '4623', '3529', '1717', '434786', '355', '524', '3167', '1506', '2032', '3763', '5592', '5612', '4280', '3213', '5911', '412', '183', '1380', '1443', '1646', '6125', '5807', '8482', '1647', '1281', '3802', '3292', '6238', '4263', '2693', '5781', '2632', '1781', '5358', '6030', '3886', '4164', '1605', '637', '2620', '1996', '5227', '1211', '5110', '2533', '3183', '2803', '2342', '4008', '3602', '4647', '206', '1569', '2710', '4096', '3118', '3268', '1414', '5916', '3884', '2534', '2762', '2529', '4394', '3249', '3406', '1579', '5921', '2317', '5577', '2322', '2510', '1659', '1260', '1789', '4686', '3396', '3128', '6199', '277', '5', '6129', '1368', '2237', '4319', '1583', '5404', '667', '4802', '8447', '7938', '79', '5614', '1400', '261', '1727', '6219', '8552', '2903', '2592', '4684', '2523', '390', '165', '3586', '2381', '1042', '4261', '2192', '1932', '6731', '1112', '1430', '607', '4835', '5254', '1092', '2205', '279', '5349', '4869', '6708', '5111', '5990', '3087', '5722', '2894', '1463', '3512', '1264', '5849', '8435', '4555', '937', '1184', '2770', '3566', '4353', '292', '1875', '2452', '1391', '2188', '4713', '1660', '5539', '3186', '4494', '1571', '1412', '4629', '2203', '3969', '6023', '3689', '2867', '6072', '1118', '4683', '2530', '5023', '2939', '1644', '6027', '3110', '3425', '6318', '580', '4454', '1739', '550', '109', '3240', '4041', '3347', '1224', '5233', '1608', '5441', '2904', '1084', '133', '2702', '3399', '4617', '2671', '4844', '5481', '3817', '1002', '3465', '1683', '5189', '817', '5244', '5265', '565', '1572', '5079', '3233', '134', '2186', '1417', '3690', '1160', '4207', '6272', '7854', '2983', '1162', '2454', '3215', '251', '3758', '4124', '444', '413', '3591', '2351', '5637', '7892', '3435', '1170', '6406', '5319', '2650', '4327', '4566', '3102', '2326', '3645', '663', '4039', '5071', '3831', '516', '1817', '5070', '445259', '2797', '747', '1228', '6359', '1736', '5707', '3872', '152', '4500', '3066', '3005', '1684', '1836', '921']


def load_topic_ids(path, all_topics):
    with open(path, 'r') as f:
        topic_ids = [[all_topics.index(t) for t in topics.strip().split()] for topics in f.readlines()]
    return topic_ids


def read_texts(path):
    with open(path, 'r') as f:
        texts = [text.strip().lower() for text in f.readlines()]
    return texts


def encode_topics_ids_to_labels(topic_ids, setting, num_topics):
    labels = None
    if setting == 'F':  # Fully Observed Labels
        labels = torch.zeros((len(topic_ids), num_topics))
        for idx, topic_idx in enumerate(topic_ids):
            labels[idx, topic_idx] = 1
    return labels


def load_bert_input(name, split, root):
    bert_input_path = f'../ckpt/bert_{name}_{split}.pkl'
    if not os.path.exists(bert_input_path):
        print(f'Bert inputs of {name} {split} do not exist. Waiting for creating...')

        texts_path = None
        if name == 'AAPD' or name == 'SemEval' or name == 'Amazon' or name == 'EUR':
            texts_path = os.path.join(root, f'text_{split}')
        if name == 'RCV1-V2':
            texts_path = os.path.join(root, f'{split}.src')
        tokenizer = BertTokenizerFast.from_pretrained('bert-base-uncased')
        if name != 'EUR':
            encoding = tokenizer(read_texts(texts_path), return_tensors='pt', max_length=320, padding=True, truncation=True)
        else:
            encoding = tokenizer(read_texts(texts_path), return_tensors='pt', max_length=510, padding=True, truncation=True)
        input_ids = encoding['input_ids']
        attention_mask = encoding['attention_mask']

        torch.save([input_ids, attention_mask], bert_input_path)
        print(f'Bert inputs of {name} {split} have been created at {bert_input_path}.')
    else:
        print(f'Bert inputs of {name} {split} exist. Loading...')
        input_ids, attention_mask = torch.load(bert_input_path)
    return input_ids, attention_mask


def load_labels(name, split, root, setting):
    saved_labels_path = f'../ckpt/labels_{name}_{split}_{setting}.pkl'
    if not os.path.exists(saved_labels_path):
        print(f'Labels {setting} of {name} {split} do not exist. Waiting for creating...')

        labels_path = all_topics = None
        if name == 'AAPD':
            labels_path = os.path.join(root, f'label_{split}')
            all_topics = aapd_topics
        if name == 'RCV1-V2':
            labels_path = os.path.join(root, f'{split}.tgt')
            all_topics = rcv1v2_topics
        if name == 'SemEval':
            labels_path = os.path.join(root, f'label_{split}')
            all_topics = SemEval_topics
        if name == 'Amazon':
            labels_path = os.path.join(root, f'label_{split}')
            all_topics = Amazon_topics
        if name == 'EUR':
            labels_path = os.path.join(root, f'label_{split}')
            all_topics = EUR_topics

        topic_ids = load_topic_ids(labels_path, all_topics)
        labels = encode_topics_ids_to_labels(topic_ids, setting, len(all_topics))

        torch.save(labels, saved_labels_path)
        print(f'Labels {setting} of {name} {split} have been created at {saved_labels_path}.')
    else:
        print(f'Labels {setting} of {name} {split} exist. Loading...')
        labels = torch.load(saved_labels_path)
    return labels


def load_dataset(name, split, root, setting='F', percentage=1.):
    if name == 'RCV1-V2' and split == 'val':
        split = 'valid'

    if not os.path.exists('../ckpt'):
        os.mkdir('../ckpt')

    input_ids, attention_mask, = load_bert_input(name, split, root)
    labels = load_labels(name, split, root, setting)

    print(f'Num of observed labels ({setting} of {name} {split}) is {(labels != -1).sum():d}.')

    return TensorDataset(torch.arange(len(labels)), input_ids, attention_mask, labels)


def load_dataset_no_val(name, split, root, setting='F', percentage=1.):

    if not os.path.exists('../ckpt'):
        os.mkdir('../ckpt')

    input_ids, attention_mask, = load_bert_input(name, split, root)
    labels = load_labels(name, split, root, setting)
    
    index = torch.randperm(input_ids.shape[0])
    input_ids_train, attention_mask_train, labels_train = input_ids[:int(input_ids.shape[0] * 0.8)], attention_mask[:int(input_ids.shape[0] * 0.8)], labels[:int(input_ids.shape[0] * 0.8)]
    input_ids_val, attention_mask_val, labels_val = input_ids[int(input_ids.shape[0] * 0.8):], attention_mask[int(input_ids.shape[0] * 0.8):], labels[int(input_ids.shape[0] * 0.8):]

    print(f'Num of observed labels ({setting} of {name} {split}) is {(labels != -1).sum():d}.')

    return TensorDataset(torch.arange(len(labels_train)), input_ids_train, attention_mask_train, labels_train),TensorDataset(torch.arange(len(labels_val)), input_ids_val, attention_mask_val, labels_val)
